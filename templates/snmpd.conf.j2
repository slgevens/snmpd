# {{ ansible_managed }}

###############################################################################
# AGENT BEHAVIOUR

agentAddress udp:{{ snmpd_agent_address }}:{% if snmpd_agent_port is defined %}{{ snmpd_agent_port }}{% else %}161
{% endif %}

###############################################################################
# ACCESS CONTROL

view   systemonly  included   .1.3.6.1.2.1.1

view   systemonly  included   .1.3.6.1.2.1.25.1

rocommunity {% if snmpd_community is defined %}{{ snmpd_community }}{% else %} public  default -V systemonly
{% endif %}

rocommunity6 {% if snmpd_communityv6 is defined %}{{ snmpd_communityv6 }}{% else %} public  default -V systemonly
{% endif %}

rouser   authOnlyUser

###############################################################################
# SYSTEM INFORMATION

sysLocation              {{ snmpd_location }}

sysContact               {{ snmpd_contact }}

sysServices              {{ snmpd_services }}

#  Process Monitoring

proc  mountd
proc  ntalkd    4
proc  sendmail 10 1

{% if snmpd_proc is defined %} ## Added with the playbook on # {{ ansible_managed }} {% else %}
{% endif %}
{% if snmpd_proc is defined %}proc {{ snmpd_proc }}{% else %}
{% endif %}
#  Disk Monitoring

disk       /     10000
disk       /var  5%
includeAllDisks  10%

{% if snmpd_proc is defined %} ## Added with the playbook on # {{ ansible_managed }} {% else %}
{% endif %}
{% if snmpd_disk is defined %}disk {{ snmpd_disk }}{% else %}
{% endif %}

#  System Load

load   12 10 5

{% if snmpd_proc is defined %} ## Added with the playbook on # {{ ansible_managed }} {% else %}
{% endif %}
{% if snmpd_load is defined %}load {{ snmpd_load }}{% else %}
{% endif %}

###############################################################################
# ACTIVE MONITORING

{% if snmpd_trapsink is defined %}trapsink {{ snmpd_trapsink }}{% else %}localhost public
{% endif %}

{% if snmpd_trap2sink is defined %}trap2sink {{ snmpd_trap2sink }}{% else %}localhost public
{% endif %}


iquerySecName            internalUser
rouser                   internalUser

defaultMonitors          yes
linkUpDownNotifications  yes

###############################################################################
# EXTENDING THE AGENT

{% if snmpd_extend is defined %}extend {{ snmpd_extend }}{% else %}
{% endif %}

{% if snmpd_extend_sh is defined %}extend-sh {{ snmpd_extend_sh }}{% else %}
{% endif %}
  
{% if snmpd_master is defined %}master {{ snmpd_master }}{% else %}
{% endif %}
